## Practicing SQL using weekly Preppin' Data Challenges
Preppin' Data is a weekly challenge created by Carl Allchin, Jenny Martin, et al.,  to help data enthusiast learn to prepare data and use Tableau prep. The data input and the expected data output can be downloaded from the [website](https://preppindata.blogspot.com). They are therefore very good resources to practice data transformation with different tools like Python or SQL.

In this repo, I share my Snowflake SQL script that I wrote to solve each weekly challenge. At the beginning of each script there are comments on the approach used to solve the task or the functions used to accomplish a particular part of the task. 

The upcoming challenge will be uploaded as soon as I complete it. If you found a error or have a question, feel free to reach out to me.


| ðŸ“†        | ðŸ—Š                                 | ðŸ”–                        | ðŸ’¡                   | ðŸ““                        |
| --------- | ------------------------------------------------ | ------------------------------------------------------------ | ----------------------------------------- | ------------------------------------------------------ |
| 2023-WK01 | The Data Source Bank                         | [SPLIT_PART](https://docs.snowflake.com/en/sql-reference/functions/split_part) - [DECODE](https://docs.snowflake.com/en/sql-reference/functions/decode)-  [CONCAT_WS](https://docs.snowflake.com/en/sql-reference/functions/concat_ws) - [IFF](https://docs.snowflake.com/en/sql-reference/functions/iff)    | [Challenge](https://preppindata.blogspot.com/2023/01/2023-week-1-data-source-bank.html)  | Extract the letters at the start of transaction code, change the date to the day of the week, redefine the type of transaction based on its field value, sum up the transaction value with different group                                                                 |
| 2023-WK02 | International Bank Account Numbers                         | [CAST,::](https://docs.snowflake.com/en/sql-reference/functions/cast) - [CONCAT](https://docs.snowflake.com/en/sql-reference/functions/concat)      | [Challenge](https://preppindata.blogspot.com/2023/01/2023-week-2-international-bank-account.html)  | Join two tables based on bank codes, cast the column to perform string manipulation, concatenate different strings to form IBAN |
| 2023-WK03 | Targets for DSB                         | [CTE](https://docs.snowflake.com/en/user-guide/queries-cte) - [UNPIVOT](https://docs.snowflake.com/en/sql-reference/constructs/unpivot) - [QUARTER](https://docs.snowflake.com/en/sql-reference/functions/year)     | [Challenge](https://preppindata.blogspot.com/2023/01/2023-week-3-targets-for-dsb.html)  | Transform columns into rows (from wide to tall), covert date to quarter, calculate variance of actual to target |
| 2023-WK04 | New Customers                         | [CREATE VIEW](https://docs.snowflake.com/en/sql-reference/sql/create-view) - [PIVOT](https://docs.snowflake.com/en/sql-reference/constructs/pivot) - [TO_DATE](https://docs.snowflake.com/en/sql-reference/functions/to_date) - [SELECT * Exclude](https://docs.snowflake.com/en/sql-reference/sql/select) - [SPLIT_PART](https://docs.snowflake.com/en/sql-reference/functions/split_part)   | [Challenge](https://preppindata.blogspot.com/2023/01/2023-week-4-new-customers.html)  | Create temporary view that union all 12 tables of each month together, transform rows into columns (from tall to wide) |
| 2023-WK05 | DBS Ranking                         | [RANK](https://docs.snowflake.com/en/sql-reference/functions/rank) - [PIVOT](https://docs.snowflake.com/en/sql-reference/constructs/pivot) - [CAST,::](https://docs.snowflake.com/en/sql-reference/functions/cast) - [DECODE](https://docs.snowflake.com/en/sql-reference/functions/decode) - [SPLIT_PART](https://docs.snowflake.com/en/sql-reference/functions/split_part)-[AVG with partition](https://docs.snowflake.com/en/sql-reference/functions/avg)         | [Challenge](https://preppindata.blogspot.com/2023/02/2023-week-5-dsb-ranking.html)  | Split out first part of the transaction code to be identified as bank, translate month number to full month name, rank each bank against the other, average transaction value and ranking with partition |
| 2023-WK06 | DBS Customer Ratings | [CTE](https://docs.snowflake.com/en/user-guide/queries-cte) - [UNPIVOT](https://docs.snowflake.com/en/sql-reference/constructs/unpivot)-[CASE](https://docs.snowflake.com/en/sql-reference/snowflake-scripting/case) - [REPLACE](https://docs.snowflake.com/en/sql-reference/functions/replace) - [RATIO_TO_REPORT](https://docs.snowflake.com/en/sql-reference/functions/ratio_to_report)     | [Challenge](https://preppindata.blogspot.com/2023/02/2023-week-6-dsb-customer-ratings.html)  | Transform the table from wide to tall structure, calculate the percentage of total using formula instead of subquery |
| 2023-WK07 | Flagging Fraudulent Suspicions | [CTE](https://docs.snowflake.com/en/user-guide/queries-cte) - [SELECT * Exclude](https://docs.snowflake.com/en/sql-reference/sql/select)-[SPLIT_TO_TABLE](https://docs.snowflake.com/en/sql-reference/functions/split_to_table)        | [Challenge](https://preppindata.blogspot.com/2023/02/2023-week-7-flagging-fraudulent.html)  | Combine multiple tables into one single table, splits the joint account holder id separated by delimiter into two rows |
| 2023-WK08 | Taking Stock | [CTE](https://docs.snowflake.com/en/user-guide/queries-cte) - [ENDSWITH](https://docs.snowflake.com/en/sql-reference/functions/endswith)-[REGEXP_SUBSTR](https://docs.snowflake.com/en/sql-reference/functions/regexp_substr) - [REPLACE](https://docs.snowflake.com/en/sql-reference/functions/replace) - [CASE](https://docs.snowflake.com/en/sql-reference/snowflake-scripting/case) - [RANK with partition](https://docs.snowflake.com/en/sql-reference/functions/rank)         | [Challenge](https://preppindata.blogspot.com/2023/02/2023-week-8-taking-stock.html)  | Categorise group based on the last letter and value within the string, rank the highest 5 purchase values and keep records with the top 5 highest purchase  |
| 2023-WK09 | Customer Bank Statements | [CTE](https://docs.snowflake.com/en/user-guide/queries-cte) - [SELECT * Exclude](https://docs.snowflake.com/en/sql-reference/sql/select)-[QUALIFY](https://docs.snowflake.com/en/sql-reference/constructs/qualify) - [SUM -RUNNING TOTAL](https://docs.snowflake.com/en/sql-reference/functions/sum)      | [Challenge](https://preppindata.blogspot.com/2023/03/2023-week-9-customer-bank-statements.html)  | Filter out cancelled transactions, combine incoming and outgoing transactions with union to carry out running total, omits duplicated rows using qualify function|
